# Goal Proposals Template

Template for `.planning/GOAL_PROPOSALS.md` - prioritized suggestions from codebase analysis.

---

## File Template

```markdown
# Goal Proposals

**Project:** [project-name]
**Generated:** [YYYY-MM-DDTHH:MM:SSZ]
**Analysis Report:** [timestamp of source ANALYSIS_REPORT.md]
**Pattern Insights:** [N patterns consulted | "No knowledge base"]

---

## Executive Summary

**Total Suggestions:** [N]
**By Priority:** [N] critical, [N] high, [N] medium, [N] low
**Estimated Quick Wins:** [N] (quick-fix effort)

---

## Prioritized Suggestions

<!-- Sorted by score descending -->

### 1. [Suggestion Title]

**Priority:** [CRITICAL | HIGH | MEDIUM | LOW]
**Score:** [N] (base [N] + effort [N] + patterns [N])
**Goal Type:** [security-fix | dependency-update | tech-debt-cleanup]
**Effort:** [quick-fix | moderate | significant]
**Count:** [N] items

**Source:** Analysis Report
**Evidence:**
- [Finding from ANALYSIS_REPORT.md]

**Pattern Insights:** <!-- If knowledge base available -->
- [Relevant pattern insight, if any]
- [Warning if high failure rate detected]

**Suggested Action:**
```
[Command or action from ANALYSIS_REPORT.md]
```

---

### 2. [Next Suggestion...]

---

## Suggestions by Goal Type

### Security Fixes
- [Suggestion title] (score: [N])
- [Suggestion title] (score: [N])

### Dependency Updates
- [Suggestion title] (score: [N])

### Tech Debt Cleanup
- [Suggestion title] (score: [N])
- [Suggestion title] (score: [N])

---

## Metadata

**Scoring Formula:**
- Base: CRITICAL=100, HIGH=75, MEDIUM=50, LOW=25
- Effort modifier: quick-fix=+20%, moderate=0%, significant=-20%
- Pattern boost: +10 if success patterns exist
- Pattern warning: Flagged if >40% failure rate in knowledge base

**Sources:**
- Analysis Report: .planning/ANALYSIS_REPORT.md
- Knowledge Base: ~/.claude/gsd-knowledge/ (if available)

**Configuration:**
- adaptive.enabled: [true | false]
- Confidence threshold: 0.6

---

*Generated by generate-suggestions workflow*
*Location: .planning/GOAL_PROPOSALS.md*
```

---

## Contract: Phase 12 → Phase 13

This template defines the contract between:
- **Phase 12 (Suggestion Engine)**: Produces GOAL_PROPOSALS.md
- **Phase 13 (CLAUDE.md Integration)**: Reads and surfaces suggestions

### Required Fields for CLAUDE.md Integration

Phase 13 expects these fields to be parseable:

| Field | Location | Format |
|-------|----------|--------|
| Total suggestions | Executive Summary | `**Total Suggestions:** [N]` |
| Priority breakdown | Executive Summary | `**By Priority:** N critical, N high, N medium, N low` |
| Quick wins count | Executive Summary | `**Estimated Quick Wins:** N` |
| Individual suggestions | Prioritized Suggestions | `### N. [Title]` sections |
| Suggestion priority | Per suggestion | `**Priority:** [PRIORITY]` |
| Suggestion score | Per suggestion | `**Score:** [N]` |
| Goal type | Per suggestion | `**Goal Type:** [type]` |
| Effort estimate | Per suggestion | `**Effort:** [effort]` |
| Suggested action | Per suggestion | Code block after `**Suggested Action:**` |

### Parsing Examples

```bash
# Get total suggestion count
grep '^\*\*Total Suggestions:\*\*' .planning/GOAL_PROPOSALS.md | grep -oE '[0-9]+'

# Get critical count
grep '^\*\*By Priority:\*\*' .planning/GOAL_PROPOSALS.md | grep -oE '[0-9]+ critical' | grep -oE '[0-9]+'

# Get quick wins count
grep '^\*\*Estimated Quick Wins:\*\*' .planning/GOAL_PROPOSALS.md | grep -oE '[0-9]+'

# Extract suggestion titles (numbered headers)
grep -E '^### [0-9]+\. ' .planning/GOAL_PROPOSALS.md | sed 's/^### [0-9]*\. //'

# Get top suggestion
sed -n '/^### 1\. /,/^### 2\. /p' .planning/GOAL_PROPOSALS.md | head -n -1

# Extract all suggestions by priority level
grep -B 5 '\*\*Priority:\*\* CRITICAL' .planning/GOAL_PROPOSALS.md

# Get suggested actions (code blocks after "Suggested Action:")
sed -n '/\*\*Suggested Action:\*\*/,/^```$/p' .planning/GOAL_PROPOSALS.md | grep -v 'Suggested Action'
```

### Compact Format for CLAUDE.md

Phase 13 should format suggestions compactly in CLAUDE.md:

```markdown
## Suggested Goals

Last analyzed: [timestamp]

**Quick Wins (N suggestions):**
1. [Title] - `[command]` (score: N)
2. [Title] - `[command]` (score: N)

**Requires Planning (N suggestions):**
- [Title] (score: N, significant effort)

Run `/gsd:suggest` to refresh or `/gsd:analyze-codebase` for new analysis.
```

---

## Scoring Formula

### Base Score (by Priority)

| Priority | Base Score | Rationale |
|----------|------------|-----------|
| CRITICAL | 100 | Security vulnerabilities, immediate action needed |
| HIGH | 75 | Significant issues requiring attention |
| MEDIUM | 50 | Important but not urgent |
| LOW | 25 | Nice to have improvements |

### Effort Modifier

| Effort | Modifier | Effect | Rationale |
|--------|----------|--------|-----------|
| quick-fix | +20% | Score × 1.2 | Favor quick wins for momentum |
| moderate | 0% | Score × 1.0 | Neutral |
| significant | -20% | Score × 0.8 | Deprioritize time-intensive work |

### Pattern Adjustments

| Condition | Adjustment | Rationale |
|-----------|------------|-----------|
| Success patterns exist | +10 | Knowledge base shows this works |
| >40% failure rate | Warning flag | Knowledge base shows this often fails |

### Example Calculation

```
Suggestion: Fix critical security vulnerabilities
Priority: CRITICAL → base 100
Effort: quick-fix → modifier +20%
Patterns: Success pattern exists → +10

Final: 100 × 1.2 + 10 = 130
```

---

## Goal Types

### security-fix
**Description:** Security vulnerability remediation
**Typical Actions:** npm audit fix, package updates, code patches
**Priority:** Usually CRITICAL or HIGH
**Source:** analyze-security.md findings

### dependency-update
**Description:** Package version updates
**Typical Actions:** npm-check-updates, manual updates, changelog review
**Priority:** Usually MEDIUM
**Source:** analyze-dependencies.md findings

### tech-debt-cleanup
**Description:** Code maintenance and cleanup
**Typical Actions:** Remove unused code, refactor, update patterns
**Priority:** Usually MEDIUM or LOW
**Source:** analyze-tech-debt.md findings

---

## Staleness Guidance

### When to Regenerate

GOAL_PROPOSALS.md should be regenerated when:

1. **Analysis report is updated** - After running `/gsd:analyze-codebase`
2. **Major dependency changes** - After `npm install`, package updates
3. **Before milestone completion** - Ensure accurate state
4. **After security advisories** - New vulnerabilities may be detected

### Staleness Detection

```bash
# Compare timestamps
ANALYSIS_TS=$(grep '^\*\*Analysis Report:\*\*' .planning/GOAL_PROPOSALS.md | sed 's/.*: *//')
CURRENT_ANALYSIS_TS=$(grep '^\*\*Generated:\*\*' .planning/ANALYSIS_REPORT.md | sed 's/.*: *//')

if [ "$ANALYSIS_TS" != "$CURRENT_ANALYSIS_TS" ]; then
  echo "STALE: Analysis report has been updated since proposals were generated"
fi

# Check file age (older than 7 days)
PROPOSALS_AGE=$(find .planning/GOAL_PROPOSALS.md -mtime +7 2>/dev/null)
if [ -n "$PROPOSALS_AGE" ]; then
  echo "STALE: Proposals older than 7 days"
fi
```

### Staleness Indicator in CLAUDE.md

Phase 13 should mark stale proposals:

```markdown
## Suggested Goals

⚠️ **Stale** - Last analyzed 14 days ago. Run `/gsd:suggest` to refresh.
```

---

## Examples

### Example 1: Multiple Suggestions

```markdown
# Goal Proposals

**Project:** my-app
**Generated:** 2026-01-08T10:30:00Z
**Analysis Report:** 2026-01-08T10:25:00Z
**Pattern Insights:** 12 patterns consulted

---

## Executive Summary

**Total Suggestions:** 5
**By Priority:** 1 critical, 2 high, 1 medium, 1 low
**Estimated Quick Wins:** 3 (quick-fix effort)

---

## Prioritized Suggestions

### 1. Fix critical security vulnerabilities

**Priority:** CRITICAL
**Score:** 130 (base 100 + effort 20 + patterns 10)
**Goal Type:** security-fix
**Effort:** quick-fix
**Count:** 2 items

**Source:** Analysis Report
**Evidence:**
- 2 critical vulnerabilities with fixes available

**Pattern Insights:**
- Strategy: npm-audit-fix (92%) works well
- Tip: Always run tests after security fixes

**Suggested Action:**
```
npm audit fix
```

---

### 2. Address high-severity vulnerabilities

**Priority:** HIGH
**Score:** 90 (base 75 + effort 0 + patterns 15)
**Goal Type:** security-fix
**Effort:** moderate
**Count:** 3 items

...
```

### Example 2: Healthy Codebase (No Suggestions)

```markdown
# Goal Proposals

**Project:** my-clean-app
**Generated:** 2026-01-08T10:30:00Z
**Analysis Report:** 2026-01-08T10:25:00Z
**Pattern Insights:** 8 patterns available

---

## Executive Summary

**Total Suggestions:** 0
**By Priority:** 0 critical, 0 high, 0 medium, 0 low
**Estimated Quick Wins:** 0

---

## Status

No actionable recommendations found in the analysis report.

This indicates your codebase is in good health:
- No critical or high-severity security vulnerabilities
- Dependencies are reasonably up to date
- Tech debt is within acceptable levels

---

## Next Steps

Consider running analysis again after:
- Major dependency updates
- New feature implementations
- Before milestone completions
```

---

## Guidelines

<guidelines>

### When Created

This file is created by the `generate-suggestions.md` workflow when:
- User runs `/gsd:suggest` command (Phase 14)
- Automatically after `/gsd:analyze-codebase` completes
- Manually triggered via workflow

### Location

Always at `.planning/GOAL_PROPOSALS.md` in the project root.

### Freshness

The file represents a point-in-time snapshot based on the analysis report.
It should be regenerated when the analysis report is updated.

### Interpretation

**Score interpretation:**
- 100+: High priority, address soon
- 75-99: Important, plan for it
- 50-74: Worth doing, but not urgent
- <50: Nice to have, opportunistic

**Quick wins strategy:**
- Start with high-score quick-fix items
- Build momentum before tackling significant effort items
- Use pattern insights to avoid known pitfalls

### Pattern Insights

When knowledge base is available (adaptive.enabled=true):
- Success patterns show what works well for similar tasks
- Failure patterns warn about common pitfalls
- Task insights provide best practices

When knowledge base is unavailable:
- Suggestions still generated from analysis report
- No pattern warnings or insights
- Consider running across multiple projects to build knowledge base

</guidelines>

---

*Template for GSD goal proposals*
